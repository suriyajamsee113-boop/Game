<!doctype html>
<html lang="th">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>แชร์ค่าอาหาร — Split Bill</title>
<style>
  :root { font-family: "Segoe UI", Roboto, "Noto Sans", Arial; --accent:#2b7a78; --muted:#666; }
  body { margin:20px; background:#f7f9fa; color:#222; }
  h1 { color:var(--accent); margin-bottom:6px; }
  .row { display:flex; gap:12px; align-items:center; margin-bottom:10px; flex-wrap:wrap; }
  input[type="text"], input[type="number"] { padding:8px; border:1px solid #ccc; border-radius:6px; min-width:160px; }
  button { padding:8px 12px; border-radius:6px; border:0; background:var(--accent); color:white; cursor:pointer; }
  button.secondary { background:#8aa9a7; }
  .box { background:white; padding:12px; border-radius:8px; box-shadow:0 1px 4px rgba(20,20,20,0.06); margin-bottom:12px; }
  #friendsList { display:flex; gap:8px; flex-wrap:wrap; }
  .friendChip { background:#eef6f6; padding:6px 10px; border-radius:20px; display:flex; gap:8px; align-items:center; }
  .friendChip button { background:transparent; color:#c0392b; padding:0 6px; border-radius:6px; }
  table { width:100%; border-collapse:collapse; margin-top:8px; }
  th, td { padding:8px; border-bottom:1px solid #eee; text-align:left; vertical-align:middle; }
  th { background:#fcffff; position:sticky; top:0; }
  .small { font-size:0.9rem; color:var(--muted); }
  .summary { display:flex; gap:16px; flex-wrap:wrap; }
  .summaryItem { background:#fff; padding:10px; border-radius:8px; min-width:220px; box-shadow:0 1px 3px rgba(20,20,20,.05); }
  .right { text-align:right; }
  .danger { background:#fff0f0; color:#b00020; padding:6px 8px; border-radius:6px; }
  .muted { color:#666; font-size:0.9rem; }
  .checkboxCell { text-align:center; }
  @media (max-width:720px) {
    table thead th:nth-child(n+4), table tbody td:nth-child(n+4) { display:block; }
  }
</style>
</head>
<body>
  <h1>แชร์ค่าอาหาร (Split Bill)</h1>
  <div class="box">
    <div class="row">
      <input id="friendName" type="text" placeholder="ใส่ชื่อเพื่อน เช่น สมชาย" />
      <button id="addFriendBtn">เพิ่มเพื่อน</button>
      <div class="muted">ชื่อเพื่อนจะแสดงเป็นตัวเลือกให้ติ๊กเวลาสร้างรายการ</div>
    </div>
    <div id="friendsList" class="row"></div>
  </div>

  <div class="box">
    <div style="display:flex;justify-content:space-between;align-items:center;">
      <div><strong>เพิ่มรายการอาหาร</strong> <span class="small muted">(ราคาต่อรายการเป็นบาท)</span></div>
      <div class="small muted">ถ้ารายการไหนยังไม่ได้ติ๊กชื่อใคร ระบบจะถือว่า "หารกับทุกคน" อัตโนมัติ</div>
    </div>
    <div class="row" style="margin-top:10px;">
      <input id="itemName" type="text" placeholder="ชื่อรายการ เช่น ข้าวผัดกุ้ง" />
      <input id="itemPrice" type="number" min="0" step="0.01" placeholder="ราคา เช่น 120.50" />
      <button id="addItemBtn">เพิ่มรายการ</button>
    </div>

    <table id="itemsTable" style="margin-top:12px;">
      <thead id="itemsThead">
        <!-- หัวตารางจะถูกสร้าง dynamic -->
      </thead>
      <tbody id="itemsTbody">
      </tbody>
    </table>
  </div>

  <div class="box">
    <strong>สรุปยอด</strong>
    <div class="summary" style="margin-top:8px;">
      <div class="summaryItem">
        <div class="small muted">ยอดรวมทั้งหมด</div>
        <div id="totalAmount" style="font-size:1.3rem; font-weight:700">฿0.00</div>
      </div>
      <div class="summaryItem" style="flex:1;">
        <div class="small muted">ยอดแต่ละคนต้องจ่าย</div>
        <div id="perPersonList" style="margin-top:8px;">
          <!-- รายชื่อแต่ละคนและยอดจ่าย -->
        </div>
      </div>
    </div>
  </div>
<script>
(() => {
  const friends = [];
  const items = [];

  const $ = (id) => document.getElementById(id);

  function formatB(cents) {
    return '฿' + (cents / 100).toFixed(2);
  }

  function uid() {
    return Math.random().toString(36).slice(2, 9);
  }

  const friendNameInput = $('friendName');
  const addFriendBtn = $('addFriendBtn');
  const friendsListDiv = $('friendsList');

  const itemNameInput = $('itemName');
  const itemPriceInput = $('itemPrice');
  const addItemBtn = $('addItemBtn');

  const itemsThead = $('itemsThead');
  const itemsTbody = $('itemsTbody');
  const totalAmountDiv = $('totalAmount');
  const perPersonListDiv = $('perPersonList');

  addFriendBtn.onclick = () => {
    const name = friendNameInput.value.trim();
    if (!name) return alert('กรุณาใส่ชื่อเพื่อน');
    friends.push({ id: uid(), name });
    friendNameInput.value = '';
    render();
  };

  addItemBtn.onclick = () => {
    const name = itemNameInput.value.trim();
    const price = Number(itemPriceInput.value);
    if (!name || isNaN(price)) return alert('กรุณากรอกข้อมูลให้ครบ');
    items.push({ name, cents: Math.round(price * 100), shares: [] });
    itemNameInput.value = '';
    itemPriceInput.value = '';
    render();
  };

  function render() {
    friendsListDiv.innerHTML = friends
      .map(f => `<div class="friendChip">${f.name}</div>`)
      .join('');

    itemsThead.innerHTML = `
      <tr>
        <th>รายการ</th>
        <th class="right">ราคา</th>
        ${friends.map(f => `<th>${f.name}</th>`).join('')}
      </tr>
    `;

    let total = 0;
    const pay = Object.fromEntries(friends.map(f => [f.name, 0]));

    itemsTbody.innerHTML = items.map(item => {
      total += item.cents;
      const shareWith = friends.length || 1;
      const each = Math.floor(item.cents / shareWith);
      friends.forEach(f => pay[f.name] += each);

      return `
        <tr>
          <td>${item.name}</td>
          <td class="right">${formatB(item.cents)}</td>
          ${friends.map(() => `<td>✓</td>`).join('')}
        </tr>
      `;
    }).join('');

    totalAmountDiv.textContent = formatB(total);
    perPersonListDiv.innerHTML = Object.entries(pay)
      .map(([name, cents]) => `<div>${name} : ${formatB(cents)}</div>`)
      .join('');
  }

})();
</script>
</body>
</html>
