<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>5 หรรษา - Neon Blue (Quick Close)</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Kanit:wght@300;600&display=swap');
        
        body { 
            font-family: 'Kanit', sans-serif; 
            background: radial-gradient(circle at center, #1a2a6c, #101820, #050505);
            color: white; 
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            justify-content: flex-start; 
            min-height: 100vh; 
            margin: 0; 
            padding: 20px; 
            box-sizing: border-box;
            touch-action: manipulation; 
        }

        h1 { 
            color: #00d2ff; 
            margin: 10px 0 25px 0; 
            font-size: 3rem; 
            text-shadow: 0 0 10px #00d2ff, 0 0 30px #00d2ff; 
            font-weight: 600;
        }

        .grid { 
            display: flex;
            flex-direction: column;
            gap: 18px; 
            width: 100%; 
            max-width: 450px; 
            flex-grow: 1;
        }

        .card { 
            flex: 1; 
            background: rgba(26, 42, 108, 0.4);
            border: 2px solid #0056b3; 
            border-radius: 20px; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            cursor: pointer; 
            font-size: 3.5rem; 
            font-weight: bold; 
            transition: all 0.3s ease; 
            text-align: center; 
            padding: 15px; 
            position: relative; 
            box-shadow: 0 0 15px rgba(0, 86, 179, 0.5);
            color: #00d2ff;
            text-shadow: 0 0 10px #00d2ff, 0 0 20px #0056b3;
            overflow: hidden;
        }

        .card:active {
            transform: scale(0.98);
        }

        .card.active { 
            background: #ffffff; 
            border-color: #00d2ff; 
            font-size: 1.3rem; 
            color: #1a2a6c; 
            text-shadow: none;
            box-shadow: 0 0 30px #ffffff; 
        }

        .timer { 
            position: absolute; 
            bottom: 8px;
            right: 15px; 
            font-size: 0.8rem; 
            background: #00d2ff; 
            color: #101820;
            padding: 2px 10px; 
            border-radius: 10px; 
            font-weight: 600;
        }
    </style>
</head>
<body>

    <h1>5 หรรษา</h1>

    <div class="grid" id="gameGrid">
        <div class="card" onclick="handleCardClick(this, 1)">1</div>
        <div class="card" onclick="handleCardClick(this, 2)">2</div>
        <div class="card" onclick="handleCardClick(this, 3)">3</div>
        <div class="card" onclick="handleCardClick(this, 4)">4</div>
        <div class="card" onclick="handleCardClick(this, 5)">5</div>
    </div>

    <script>
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        const activeTimers = {}; // เก็บอ้างอิงของ Interval ของแต่ละปุ่ม

        function playBeep() {
            if (audioCtx.state === 'suspended') audioCtx.resume();
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.type = 'sine';
            osc.frequency.setValueAtTime(800, audioCtx.currentTime);
            gain.gain.setValueAtTime(0.05, audioCtx.currentTime);
            gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.1);
            osc.connect(gain);
            gain.connect(audioCtx.destination);
            osc.start();
            osc.stop(audioCtx.currentTime + 0.1);
        }

        const punishments = [
            "กินครึ่งแก้ว 🍺", "คนซ้ายมือดื่ม! 👈", "คนขวามือดื่ม! 👉", "ลุกขึ้นเต้น 10 วิ 💃", "หมดแก้ว! 🥂", "รอดตัวไป 😎", "สั่งใครก็ได้ดื่ม ☝️", "ดื่มตามจุดบนเสื้อ 👕", "ชื่อสัตว์ 5 ชนิดใน 3 วิ 🦁", "จ้องตาเพื่อน (หลบก่อนดื่ม) 👁️", "คนโสดดื่ม! 💔", "คนมีแฟนดื่ม! ❤️", "หาเพื่อนดื่ม 1 คน 🍻", "คว่ำแก้ว! ⬇️", "ห้ามพูด 'ไม่' 5 นาที 🤐", "ท่าตลก 1 ท่า 🤡", "ชนแก้วรอบวง 🍻", "หมดแก้วทั้งกลุ่ม! 💀", "เล่าเรื่องน่าอาย 😳", "เพศตรงข้ามดื่ม 👫", "คนใส่กางเกงยีนส์ดื่ม 👖", "คนผมสั้นดื่ม 💇", "ใครอายุน้อยสุดดื่ม 👶", "ใครอายุมากสุดดื่ม 🧓", "ดื่ม 2 อึก ✌️", "คนใส่เสื้อสีดำดื่ม 🖤", "คนใส่เสื้อขาวดื่ม 🤍", "วิดพื้น 5 ที 💪", "ให้คนข้างๆ สั่งอะไรก็ได้ 👑", "ใครถือโทรศัพท์อยู่ดื่ม 📱", "คนสูงที่สุดในโต๊ะดื่ม 🦒", "คนเตี้ยที่สุดในโต๊ะดื่ม 🐧", "ดื่มน้ำเปล่า 1 แก้ว 💧", "สมมติว่าเป็นแมว 1 นาที 🐱", "คนมีเงินเยอะสุดดื่ม 💰", "แลกแก้วกับคนซ้ายมือ 🔄", "ห้ามใช้มือจับแก้ว 3 นาที 🚫", "ร้องเพลงท่อนฮิต 🎤", "ใครมีรอยสักดื่ม 🎨", "คนใส่แว่นดื่ม 👓", "ห้ามพูดชื่อเพื่อน 5 นาที 🙊", "ใบ้คำให้เพื่อนทาย 🤐", "หัวเราะแบบนางร้าย 😈", "กระโดดตบ 10 ครั้ง 🤸", "เป่ายิ้งฉุบคนขวา แพ้ดื่ม ✌️", "จิบเบาๆ 1 ทีพอ 😋",
            "ใครใส่แหวน ดื่ม! 💍", "ใครใส่ต่างหู รอด! ✅", "ใครไม่ใส่นาฬิกา รอด! ✅", "เสื้อสีขาว ดื่ม! ⚪", "เสื้อสีดำ ดื่ม! ⚫", "ใส่รองเท้าผ้าใบ ดื่ม! 👟", "ใส่รองเท้าแตะ รอด! 🩴", "ฉีดน้ำหอมมา ดื่ม! 💨", "ทำสีผม ดื่ม! 🌈", "ใส่สายสิญจน์ ดื่ม! 🧶", "พกยาดม ดื่ม! 👃", "ใส่กางเกงขาสั้น รอด! 🩳", "ทาสีเล็บ ดื่ม! 💅", "ใส่เสื้อกันหนาว ดื่ม! 🧥", "พกเงินสด ดื่ม! 💵", "พาวเวอร์แบงค์วางอยู่ ดื่ม! 🔋", "พกกุญแจรถ ดื่ม! 🔑", "คนผมยาว ดื่ม! 👱‍♀️", "คนหน้ามัน ดื่ม! ✨", "ใส่สร้อยคอ ดื่ม! 📿", "แอพธนาคารสีเขียว ดื่ม! 🟩", "ใช้ iPhone ดื่ม! 🍎", "ใช้ Android รอด! 🤖", "สายตาปกติ รอด! 👀", "ใส่หมวก ดื่ม! 🧢", "เสื้อมีกระดุม ดื่ม! 👔", "เสื้อมีลายการ์ตูน ดื่ม! 🐥", "สะพายกระเป๋า ดื่ม! 👜", "ไว้หนวดเครา ดื่ม! 🧔", "ใส่ถุงเท้า ดื่ม! 🧦", "พกหูฟังมา ดื่ม! 🎧", "ใส่แมสก์ค้างไว้ ดื่ม! 😷", "ใส่เสื้อเชิ้ต ดื่ม! 👔", "ใส่กางเกงวอร์ม รอด! 🏃", "มีเหรียญในเป๋า ดื่ม! 🪙", "พกบัตรประชาชน ดื่ม! 🪪", "ใส่รองเท้าส้นสูง ดื่ม! 👠", "ไว้เล็บยาว ดื่ม! 💅", "ใส่เข็มขัด ดื่ม! 🔗", "รูปแฟนขึ้นหน้าจอ ดื่ม! 📱", "ใส่เสื้อยืด ดื่ม! 👕", "พกผ้าเช็ดหน้า รอด! 🧊", "เสื้อสีน้ำเงิน ดื่ม! 🔵", "ยิ้มสวย รอด! 😁", "เป็นคนชวนมา ดื่ม! 📣", "เกิดเดือนนี้ ดื่ม! 🎂", "ใส่สร้อยข้อมือ ดื่ม! ⌚", "พกจีช็อค ดื่ม! ⌚", "ย้อมผมสีเข้ม รอด! 💆", "ยังไม่ได้อาบน้ำ ดื่ม! 🚿"
        ];

        function resetCard(element, originalNumber) {
            clearInterval(activeTimers[originalNumber]); // หยุดตัวนับเวลา
            element.classList.remove('active');
            element.innerHTML = originalNumber;
            delete activeTimers[originalNumber];
        }

        function handleCardClick(element, originalNumber) {
            // ฟังชั่นใหม่: ถ้ากดซ้ำตอนที่แสดงบทลงโทษอยู่ ให้ปิดทันที
            if (element.classList.contains('active')) {
                playBeep();
                resetCard(element, originalNumber);
                return;
            }

            playBeep();
            if (navigator.vibrate) navigator.vibrate(100);

            const punishment = punishments[Math.floor(Math.random() * punishments.length)];
            element.innerHTML = punishment + `<div class="timer" id="t-${originalNumber}">10</div>`;
            element.classList.add('active');

            let timeLeft = 10;
            const timerElement = document.getElementById(`t-${originalNumber}`);
            
            // เริ่มการนับถอยหลังและเก็บไว้ใน Object เพื่อให้ปิดได้ภายหลัง
            activeTimers[originalNumber] = setInterval(() => {
                timeLeft--;
                if (timerElement) timerElement.innerText = timeLeft;
                if (timeLeft <= 0) {
                    resetCard(element, originalNumber);
                }
            }, 1000);
        }
    </script>
</body>
</html>
